<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>E Repository</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="E-Repository.css">
</head>

<body>
    <section>
        <div class="lr">
            <div>
                <div class=" logo">
                    <h2>E-Repository</h2>
                </div>

            </div>
            <div class="navs">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="eExam.html">E-exam</a></li>
                    <li><a href="of.html">Openforum</a></li>
                    <li><a href="myWall.html">My Wall</a></li>

                </ul>
            </div>
            <div>
                <h2>Hello <span id="namegreet"></span></h2>
            </div>
        </div>

    </section>
    <div class="container">
        <form id='form'>
            <div class="input-group">
                <label for='name'>Your name</label>
                <input name='name' id='name' placeholder="Enter your name" />
            </div>
            <div class="input-group">
                <label for='files'>Select files</label>
                <div class="file-select">
                    <svg id="icon" height="210" width="400">
                        <path d="M40.213 10.172c1.897.21 3.68.738 5.35 1.58a15.748 15.748 0 0 1 4.374 3.242 15.065 15.065 0
                        0 1 2.951 4.533c.72 1.704 1.08 3.522 1.08 5.455 0 1.827-.28 3.654-.843 5.48-.562 1.828-1.379
                        3.47-2.45 4.929A13.39 13.39 0 0 1 46.669 39c-1.599.948-3.452 1.458-5.56 1.528H37.26a1.62 1.62
                        0 0 1-1.185-.5 1.62 1.62 0 0 1-.501-1.186c0-.457.167-.852.5-1.186.334-.334.73-.5
                        1.186-.5h3.848c1.44 0 2.75-.37 3.926-1.108a10.851 10.851 0 0 0 3.03-2.846 13.53 13.53 0 0 0
                        1.95-3.9 14.23 14.23 0 0 0 .686-4.321c0-1.582-.316-3.066-.949-4.454a11.623 11.623 0 0
                        0-2.582-3.636 12.857 12.857 0 0 0-3.742-2.478 11.054 11.054 0 0
                        0-4.48-.922l-1.212-.053-.37-1.159c-.878-2.81-2.292-4.998-4.242-6.562-1.95-1.563-4.594-2.345-7.932-2.345-2.108
                        0-4.005.36-5.692 1.08-1.686.72-3.136 1.722-4.348 3.005-1.212 1.282-2.143 2.81-2.793 4.585-.65
                        1.774-.975 3.68-.975 5.718h.053l.105 1.581-1.528.264c-1.863.316-3.444 1.317-4.744 3.004-1.3
                        1.686-1.95 3.584-1.95 5.692 0 2.39.8 4.462 2.398 6.219 1.599 1.757 3.488 2.635 5.666
                        2.635h4.849c.492 0 .896.167 1.212.5.316.335.474.73.474 1.187 0 .456-.158.852-.474
                        1.185-.316.334-.72.501-1.212.501h-4.849a10.08 10.08 0 0 1-4.374-.975 11.673 11.673 0 0
                        1-3.61-2.661 13.173 13.173 0 0 1-2.478-3.9A12.073 12.073 0 0 1 0 28.301c0-2.706.755-5.148
                        2.266-7.326 1.511-2.178 3.444-3.636 5.798-4.374.14-2.354.658-4.542 1.554-6.562.896-2.02
                        2.091-3.777 3.584-5.27 1.494-1.494 3.25-2.662 5.27-3.505C20.493.422 22.733 0 25.193 0c1.898 0
                        3.637.237 5.218.711 1.581.475 3.004 1.151 4.269 2.03a13.518 13.518 0 0 1 3.268 3.215 18.628
                        18.628 0 0 1 2.266 4.216Zm-11.964 13.44 6.22 6.85c.245.247.368.537.368.87 0
                        .334-.123.642-.369.923l-.421.263c-.211.246-.484.343-.817.29a1.544 1.544 0 0
                        1-.87-.448l-3.69-4.11v16.97c0 .492-.166.896-.5 1.212-.334.316-.729.474-1.186.474-.492
                        0-.896-.158-1.212-.474-.316-.316-.474-.72-.474-1.212V28.25l-3.584 4.005a1.544 1.544 0 0
                        1-.87.448.959.959 0 0 1-.87-.29l-.42-.264c-.247-.28-.37-.588-.37-.922
                        0-.334.123-.624.37-.87l6.113-6.746v-.052l.421-.422a.804.804 0 0 1
                        .396-.29c.158-.053.307-.079.448-.079.175 0
                        .333.026.474.079.14.053.281.15.422.29l.421.422v.052Z" />
                    </svg>
                    <input id='files' type="file" multiple>
                </div>

            </div>
            <button class="submit-btn" type='submit'>Upload</button>

        </form>
        <hr>
        <div class="vault">
            <button class="submit-btn">
                <a style="color:white;font-size: 18px;" href="documents.html">Vault</a>
            </button>
        </div>
    </div>


    <script>
        const user = localStorage.getItem("id");
        async function fetchUsersByID(id) {
            const result = await fetch(`http://localhost:8081/user/${id}`);
            const userDetails = await result.json();
            return userDetails;
        }

        fetchUsersByID(`${user}`).then((data) => {
            console.log(data);
            document.getElementById("namegreet").innerHTML = data.name
            document.getElementById("name").value = data.name;
            var name = document.getElementById("name");
        });
        const form = document.getElementById("form");
        form.addEventListener("submit", submitForm);

        function submitForm(e) {
            e.preventDefault();
            const name = document.getElementById("name");
            const files = document.getElementById("files");
            const formData = new FormData();
            formData.append("name", name.value);
            for (let i = 0; i < files.files.length; i++) {
                formData.append("files", files.files[i]);
            }
            fetch("http://localhost:8081/upload_files", {
                method: 'POST',
                body: formData,
                headers: {
                    // "Content-Type": "multipart/form-data"
                }
            })
                .then((res) => console.log(res))
                .catch((err) => ("Error occured", err));
        }
    </script>
</body>

</html>